CREATE OR REPLACE procedure SYS.DEL_PART_OF_TABLE IS
	l_date TIMESTAMP;
	l_days INTEGER;
BEGIN

	SELECT TO_NUMBER(VALUE) INTO l_days FROM DIDAR.SETTINGS where key = 'days_bigger_delete';  --number of days that are used need to delete

	FOR a IN (SELECT PARTITION_NAME,HIGH_VALUE,TABLE_OWNER,TABLE_NAME FROM DBA_TAB_PARTITIONS WHERE TABLE_NAME = 'TM_SOAP_NOTIFY2' and partition name not in ('P0') and table_owner='TM' ) LOOP
		EXECUTE IMMEDIATE "BEGIN :ret := '||a.HIGH VALUEI|'; END;' USING OUT l_date;
		If l_date < sysdate - l_date THEN
		BEGIN
			EXECUTE IMMEDIATE 'ALTER TABLE '||a.TABLE_OWNER||'.'||a.TABLE_NAME||' TRUNCATE PARTITION '||a.PARTITION_NAME||' UPDATE GLOBAL INDEXES PARALLEL 16';
			EXECUTE IMMEDIATE 'ALTER TABLE '||a.TABLE_OWNER||'.'||a.TABLE_NAME||' DROP PARTITION '||a.PARTITION_NAME||' UPDATE GLOBAL INDEXES PARALLEL 16'; 
		End;
		End if; 
	End loop;
End;